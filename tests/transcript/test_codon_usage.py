"""
Test codon_usage
"""

from tests.transcript.config import transcript2
import pandas.util.testing as pdt
import pandas as pd


# devide by 1638

def test_codon_usage(transcript2):
    res = transcript2.codon_usage()
    dict_test = {'AAA': {0: -6.1541576855839955},
                 'AAC': {0: -6.977279923499917},
                 'AAG': {0: -5.870364719583405},
                 'AAT': {0: -7.870364719583405},
                 'ACA': {0: -6.77082904603249},
                 'ACC': {0: -9.677719641641009},
                 'ACG': {0: -9.677719641641009},
                 'ACT': {0: -7.6777196416410085},
                 'AGA': {0: -7.218288023003711},
                 'AGC': {0: -6.590256800390669},
                 'AGG': {0: -6.6777196416410085},
                 'AGT': {0: -8.355791546753647},
                 'ATA': {0: -8.355791546753647},
                 'ATC': {0: -7.6777196416410085},
                 'ATG': {0: -6.285402218862249},
                 'ATT': {0: -7.355791546753646},
                 'CAA': {0: -7.6777196416410085},
                 'CAC': {0: -6.977279923499917},
                 'CAG': {0: -7.507794640198696},
                 'CAT': {0: -9.092757140919852},
                 'CCA': {0: -7.870364719583405},
                 'CCC': {0: -7.507794640198696},
                 'CCG': {0: -8.677719641641009},
                 'CCT': {0: -7.870364719583405},
                 'CGA': {0: -9.092757140919852},
                 'CGC': {0: -8.677719641641009},
                 'CGG': {0: -9.677719641641009},
                 'CGT': {0: -8.677719641641009},
                 'CTA': {0: -8.092757140919852},
                 'CTC': {0: -7.092757140919852},
                 'CTG': {0: -7.870364719583405},
                 'CTT': {0: -7.092757140919852},
                 'GAA': {0: -7.6777196416410085},
                 'GAC': {0: -6.6777196416410085},
                 'GAG': {0: -6.507794640198696},
                 'GAT': {0: -7.870364719583405},
                 'GCA': {0: -9.677719641641009},
                 'GCC': {0: -7.870364719583405},
                 'GCG': {0: -9.677719641641009},
                 'GCT': {0: -6.6777196416410085},
                 'GGA': {0: -6.977279923499917},
                 'GGC': {0: -6.033863451866284},
                 'GGG': {0: -7.507794640198696},
                 'GGT': {0: -7.870364719583405},
                 'GTA': {0: -8.677719641641009},
                 'GTC': {0: -7.870364719583405},
                 'GTG': {0: -7.092757140919852},
                 'GTT': {0: -8.092757140919852},
                 'TAC': {0: -7.6777196416410085},
                 'TAT': {0: -8.092757140919852},
                 'TCA': {0: -8.355791546753647},
                 'TCC': {0: -7.6777196416410085},
                 'TCG': {0: -9.677719641641009},
                 'TCT': {0: -7.6777196416410085},
                 'TGC': {0: -6.285402218862249},
                 'TGG': {0: -6.355791546753646},
                 'TGT': {0: -7.6777196416410085},
                 'TTA': {0: -7.6777196416410085},
                 'TTC': {0: -7.355791546753646},
                 'TTG': {0: -9.092757140919852},
                 'TTT': {0: -6.590256800390669}}
    df_test = pd.DataFrame(data=dict_test)
    pdt.assert_frame_equal(df_test, res)
